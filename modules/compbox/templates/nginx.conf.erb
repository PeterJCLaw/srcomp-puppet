server {
    listen 80 default_server;
    listen [::]:80 default_server ipv6only=on;

<% if @redirect_tls %>
    server_name     srcomp.studentrobotics.org;
    return          301 https://$server_name$request_uri;
<% else %>
    include includes/compbox;
<% end %>
}
server {
    listen 443 ssl;
    listen [::]:443 ssl ipv6only=on;

<% if @letsencrypt %>
    server_name     srcomp.studentrobotics.org;

    ssl_certificate /etc/letsencrypt/live/srcomp.studentrobotics.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/srcomp.studentrobotics.org/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
<% else %>
    server_name compbox;

    ssl_certificate /etc/ssl/certs/ssl-cert-snakeoil.pem;
    ssl_certificate_key /etc/ssl/private/ssl-cert-snakeoil.key;
<% end %>

    include includes/compbox;
}
